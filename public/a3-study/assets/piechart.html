<!DOCTYPE html>
<div id="container"></div>
<script type="module">

    import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

    import * as randomData from "./shared/genRandomData.js";

    const container = document.getElementById("container");

    let dataPoints = randomData.getData();
    let compareIndexes = randomData.getBarsToCompare(dataPoints);

    //set dimensions
    const width = 500;
    const height = 500;

    const pie = d3.pie()
        .sort(null)
        .value(d => d)

    const arc = d3.arc()
        .innerRadius(0)
        .outerRadius(height / 2 - 4)

    const svg = d3.create("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("viewBox", [-width / 2, -height / 2, width, height]);

    //create each part of the pie chart
    svg.append("g")
        .selectAll()
        .data(pie(dataPoints))
        .join("path")
        .attr("stroke", "black")
        .attr("stroke-width", 3)
        .attr("fill", "#c2d4f2")
        .attr("d", arc);

    //mark points to compare
    svg.append("g")
        .selectAll()
        .data(pie(dataPoints).filter((d, i) => compareIndexes.includes(i)))
        .join("circle")
        .attr("transform", d => `translate(${arc.centroid(d)})`)
        .attr("r", 15)
        .style("fill", d => (d.index === Math.min(...compareIndexes)) ? "#f04400" : "black");


    container.append(svg.node());


</script>